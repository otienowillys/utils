/* Step 1: Import the Excel Data */
proc import datafile="path/to/data.xlsx"
    out=mydata
    dbms=xlsx
    replace;
    sheet="Sheet1";
    getnames=yes;
run;

/* Step 2: Concatenate Rows Based on { and } */
data combined_data;
    set mydata;
    length full_text $5000; /* Adjust length as needed */
    retain full_text in_braces 0; /* Track whether we're inside braces */

    /* Check if the row starts with '{' */
    if index(your_column_name, '{') then do;
        in_braces + 1; /* Increment if we find an opening brace */
    end;

    /* Concatenate the current row */
    full_text = catx(' ', full_text, your_column_name);

    /* Check if the row ends with '}' */
    if index(your_column_name, '}') then do;
        in_braces - 1; /* Decrement if we find a closing brace */
    end;

    /* Output the accumulated text if we're back to zero braces */
    if in_braces = 0 and full_text ne '' then do;
        output; /* Output the concatenated result */
        full_text = ''; /* Reset for the next section */
    end;

    /* If this is the last row, check if there's any remaining text */
    if eof and full_text ne '' then do;
        output;
    end;
run;

/* Step 3: Extract Text Between Curly Braces */
data extracted_data;
    set combined_data;

    /* Regular expression to find text between curly braces */
    retain regex;
    if _N_ = 1 then do;
        regex = prxparse('/\{(.*?)\}/');
    end;

    /* Extract the text */
    if prxmatch(regex, full_text) then do;
        extracted_text = prxposn(regex, 1, full_text);
    end;
    else do;
        extracted_text = ''; /* If no match found */
    end;

    /* Keep only the necessary columns */
    keep extracted_text;
run;

proc print data=extracted_data;
run;
